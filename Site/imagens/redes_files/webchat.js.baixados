!function(e,t){"use strict";class i extends Error{constructor(e){super("[SZ]: "+e),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}}class s{isMobile(){return/Mobi/.test(navigator.userAgent)}getBrowserNameVersion(){let e,t,i,s=navigator.userAgent,o=navigator.appName,r=""+parseFloat(navigator.appVersion);return-1!=(t=s.indexOf("Opera"))?(o="Opera",r=s.substring(t+6),-1!=(t=s.indexOf("Version"))&&(r=s.substring(t+8))):-1!=(t=s.indexOf("MSIE"))?(o="Microsoft Internet Explorer",r=s.substring(t+5)):-1!=(t=s.indexOf("Chrome"))?(o="Chrome",r=s.substring(t+7)):-1!=(t=s.indexOf("Safari"))?(o="Safari",r=s.substring(t+7),-1!=(t=s.indexOf("Version"))&&(r=s.substring(t+8))):-1!=(t=s.indexOf("Firefox"))?(o="Firefox",r=s.substring(t+8)):(e=s.lastIndexOf(" ")+1)<(t=s.lastIndexOf("/"))&&(o=s.substring(e,t),r=s.substring(t+1),o.toLowerCase()==o.toUpperCase()&&(o=navigator.appName)),-1!=(i=r.indexOf(";"))&&(r=r.substring(0,i)),-1!=(i=r.indexOf(" "))&&(r=r.substring(0,i)),{name:o,version:r}}getBrowserName(){return this.getBrowserNameVersion().name}getBrowserVersion(){return this.getBrowserNameVersion().version}storageAvailable(t){try{var i=e[t],s="__storage_test__";return i.setItem(s,s),i.removeItem(s),!0}catch(e){return!1}}getCurrentUrl(){return e.location.href}getLanguage(){return navigator.language}static getBrowser(){const i=new s;return{browser:i.getBrowserName(),browserVersion:i.getBrowserVersion(),language:i.getLanguage(),languages:navigator.languages,userAgent:navigator.userAgent,device:i.isMobile()?"Mobile":"Desktop",isMobile:i.isMobile(),referrer:t.referrer||"N/A",online:navigator.onLine,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screenResolution:screen.width+" x "+screen.height,screenWidth:screen.width,screenHeight:screen.height,windowWidth:e.width,windowHeight:e.innerHeight,cookieEnabled:navigator.cookieEnabled,sessionStorageAvaiable:i.storageAvailable("sessionStorage"),localStorageAvaiable:i.storageAvailable("localStorage"),origin:i.getCurrentUrl()}}}var o=new class{constructor(e={}){if("object"!=typeof e)throw new i("The constructor options need to be an object!");this.defaultOptions={host:null,debug:!1,debug_api:null,iframeId:"iframe-sz-chat",button_label:void 0,cid:null,fid:null,style:{border:0,position:"fixed",bottom:0,right:0,display:"block"},"z-index":2147483640,browserInfo:null,chat:{online:null,width:380,height:550,closedWidth:96,closedHeight:122,locale:"pt-BR",autoDetectLanguage:!1,button:{},label:{enabled:!0}},user:{}},this.userParamPrefix="szf_",this.optionsParamPrefix="szo_",this.args={},this.options=Object.assign(this.defaultOptions,e),this.availableLanguages=["pt-BR","en"],this._listeners=["onReady","beforeOpen","onOpen","afterOpen","beforeClose","onClose","afterClose"],this._methods=["chatOpen","chatClose","chatHide"],this._triggers={},this._queue=[],this.iframeElement,this.ready=!1,this.isOpen=!1,this.isOpening=!1,this.bodyOriginalStyle}szCdnDomain(){return e.location.origin.startsWith("https://cdn")?"https://cdn.webchat.sz.chat/":`${this.options.host}/webchat/v2/`}debug(){if(this.options.debug){console.log("[SZ]: ",...arguments);const i="sz4_console_debug",s={...arguments};let o=t.getElementById(i);if(o){var e=t.createElement("pre");e.appendChild(t.createTextNode(JSON.stringify(s,null,2))),o.appendChild(e)}}}serialize(e){return"?"+Object.keys(e).reduce(function(t,i){return void 0!==e[i]&&t.push(i+"="+encodeURIComponent(e[i])),t},[]).join("&")}debounce(e,t,i){var s;return function(){var o=this,r=arguments,n=i&&!s;clearTimeout(s),s=setTimeout(function(){s=null,i||e.apply(o,r)},t),n&&e.apply(o,r)}}on(e,t){this._triggers[e]||(this._triggers[e]=[]),this._triggers[e].push(t)}call(e,t){if(this.debug("[CALL]",typeof this[e],e,t),"function"!=typeof this[e])throw new i(`Method: ${e} don't exists`);this.debug(this[e](t))}execQueue(){this._queue.length&&this._queue.forEach(e=>{var t=Object.keys(e)[0],i=e[t];this.call(t,i)})}trigger(e,t){if(-1===this._listeners.indexOf(e))throw new i(`Unknown event: ${e}`);if(this._triggers[e])for(var s in this._triggers[e])this._triggers[e][s](t)}getFrameHost(){let e="";e=this.options.debug&&this.options.debug_api?this.options.debug_api+"/webchat/v2/":this.szCdnDomain();let t={};return Object.keys(this.options.user).forEach(e=>{t[this.userParamPrefix+""+e]=this.options.user[e]}),e+this.serialize({cid:this.options.cid,debug:!!this.options.debug||void 0,button_label:this.options.button_label||void 0,debug_api:this.options.debug_api?this.options.debug_api:void 0,host:this.options.host,locale:this.getLocale(),...t})}getLocale(){return this.options.chat.autoDetectLanguage&&this.options.browserInfo?this.availableLanguages.find(e=>-1!==e.indexOf(this.options.browserInfo.language)||-1!==e.indexOf(this.options.browserInfo.language.split("-")[0])):this.availableLanguages.includes(this.options.chat.locale)?this.options.chat.locale:this.availableLanguages[0]}setUserUrlParams(){const t=new URL(e.location.href);for(let e of t.searchParams)e[0].startsWith(this.userParamPrefix)&&(this.options.user[this.parseUserParam(e[0])]=e[1].replace(/(<([^>]+)>)/gi,""))}setOptionsUrlParams(){const t=new URL(e.location.href),i=["debug","debug_api","cid","fid","z-index"];for(let e of t.searchParams)if(e[0].startsWith(this.optionsParamPrefix)){let t=this.parseUserParam(e[0]);-1!==i.indexOf(t)&&(this.options[t]=e[1])}}createFrame(){if(!this.options.host)throw new i('The "host" property is required');return new Promise(e=>{let i=t.createElement("iframe"),s=t.getElementById(this.options.iframeId);s&&s.remove(),this.options.style["z-index"]=this.options["z-index"],i.id=this.options.iframeId,i.width=0,i.height=0,i.scrolling="no",i.src=this.getFrameHost(),i.allow="microphone",i.style=Object.keys(this.options.style).map(e=>`${e}: ${this.options.style[e]}`).join(";"),this.iframeElement=t.body.appendChild(i),e()})}sendBrowserInfo(){this.debug("Send browser info"),this.sendMessageToFrame({action:"browserInfo",payload:this.options.browserInfo})}getBrowserInfo(){this.options.browserInfo=s.getBrowser(),this.debug("Get browser info",s.getBrowser())}chatOpen(e){this.ready&&this.sendMessageToFrame({action:"chat:open",payload:e})}chatClose(e){this.sendMessageToFrame({action:"chat:close",payload:e})}chatHide(){this.sendMessageToFrame({action:"chat:hide"})}setOptions(e={}){this.options.chat=Object.assign(this.options.chat,e),this.resizeFrame(),this.sendMessageToFrame({action:"chat:set-options",payload:this.options.chat})}setArgs(e){this.debug("ARGS!",e),!Array.isArray(e)||Array.from(e).filter(e=>e.length>0).map(e=>({[e[0]]:e[1]})).forEach((e,t)=>{var i=Object.keys(e)[0];i in this.options&&"style"!==i&&(this.options[i]=this.args[i]=e[i]),i in this.options.chat&&(this.options.chat[i]=this.args[i]=e[i]),i.startsWith(this.userParamPrefix)&&(this.options.user[this.parseUserParam(i)]=e[i]),-1!==this._listeners.indexOf(i)&&this.on(i,e[i]),-1!==this._methods.indexOf(i)&&this._queue.push(e)})}parseUserParam(e){let t=e.split("_");return t.shift(),t.join("_")}onResize(){this.sendBrowserInfo(),this.resizeFrame(),this.togglePageScroll(),this.disableZoom()}resizeFrame(e,t){if(this.debug("Resize: ",e,t),void 0!=e||void 0!=t)this.iframeElement.width=e,this.iframeElement.height=t;else{var i=this.getFrameSize();this.debug("getFrameSize: ",i.width,i.height),this.iframeElement.width=i.width,this.isMobile||(this.iframeElement.height=i.height)}}getSizeFrameCheckLabel(e){return this.sendMessageToFrame({action:"chat-iframe-resize"}),e?{height:95,width:380}:{width:85,height:85}}getFrameSize(){var t,i=0;if(!0===this.isOpening||!0===this.isOpen)this.options.browserInfo&&this.options.browserInfo.isMobile?(t="100%",i=e.innerHeight):(t=this.options.chat.width,i=this.options.chat.height);else if(this.ready){const e=this.getSizeFrameCheckLabel(this.options.chat.label.enabled);t=e.width,i=e.height}return this.debug("getFrameSize:",{BO:this.options.browserInfo,width:t,height:i,isOpen:this.isOpen,isOpening:this.isOpening,mobile:this.options.browserInfo.isMobile,options:this.options.chat}),{width:t,height:i}}togglePageScroll(){this.options.browserInfo.isMobile&&(!0===this.isOpen||!0===this.isOpening?(t.body.style.position="fixed",t.body.style.overflow="hidden",t.body.style.height="100vh",t.body.style.minHeight="100vh"):(t.body.style.position=this.bodyOriginalStyle.position,t.body.style.overflow=this.bodyOriginalStyle.overflow,t.body.style.height=this.bodyOriginalStyle.height,t.body.style.minHeight=this.bodyOriginalStyle.minHeight))}disableZoom(){var i=t.querySelector("meta[name=viewport]"),s="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0";i||((i=t.createElement("meta")).setAttribute("content",s),t.getElementsByTagName("head")[0].appendChild(i)),i.setAttribute("content",s),e.addEventListener("orientationchange",function(){i.setAttribute("content",s)},!1)}onMessage(e){switch(e.data.action){case"chat-ready":this.debug("Chat is ready",this),this.ready=!0,this.sendBrowserInfo(),this.trigger("onReady",this),this.execQueue();break;case"chat-opening":this.debug("Chat opening"),this.isOpening=!0,this.resizeFrame(),this.trigger("beforeOpen",this),this.execQueue();break;case"chat-opened":this.debug("Chat opened"),this.isOpen=!0,this.trigger("onOpen",this),this.isOpening=!1,this.togglePageScroll(),this.disableZoom(),this.trigger("afterOpen",this),this.execQueue();break;case"chat-closing":this.debug("Chat closing"),this.trigger("beforeClose",this),this.execQueue();break;case"chat-closed":this.debug("Chat closed"),this.isOpen=!1,this.trigger("onClose",this),this.resizeFrame(),this.togglePageScroll(),this.disableZoom(),this.trigger("afterClose",this),this.execQueue();break;case"chat-hidden":this.debug("Chat hidden"),this.resizeFrame(0,0);break;case"chat-iframe-resize":this.resizeFrame(e.data.width,e.data.height);break;case"chat:hide":this.debug("Chat hide"),this.isOpen=null;break;case"chat-error":this.debug(e.data.error);break;case"input-focus":this.debug("Input focus");break;case"chat-label-off":this.options.chat.label.enabled=!1,this.onResize();break;case"chat:set-options":this.setOptions(JSON.parse(e.data.options))}}sendMessageToFrame(e){if(!this.iframeElement)throw new i("Unable to connect on chat frame");this.iframeElement.contentWindow.postMessage(e,"*")}mergeOptions(e){Object.keys(e).filter(e=>e in this.defaultOptions).forEach(t=>this.defaultOptions[t]=e[t])}init(){e.webchat&&(this.debug("Init SZchat",e.webchat),this.bodyOriginalStyle={position:t.body.style.position,overflow:t.body.style.overflow,height:t.body.style.height,minHeight:t.body.style.minHeight},this.setOptionsUrlParams(),this.setUserUrlParams(),this.setArgs(e.webchat.q),this.getBrowserInfo(),e.webchat=this,this.createFrame())}};o.init(),o.debug("SZ instance",o),e.addEventListener("resize",o.debounce(function(){o.onResize()},300)),e.addEventListener("message",function(e){o.onMessage(e)})}(window,document);